(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{2694:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/marketplace",function(){return t(1707)}])},2041:function(e,s,t){"use strict";t.d(s,{B:function(){return u},x:function(){return d}});var r,a=t(7568),n=t(6042),i=t(9534),l=t(655),c=t(8100),d=15,o=(r=(0,a.Z)(function(e){var s,t,r;return(0,l.__generator)(this,function(s){switch(s.label){case 0:return[4,fetch(e)];case 1:return[4,s.sent().json()];case 2:return[2,null!==(r=s.sent().market_data.current_price.usd)&&void 0!==r?r:null]}})}),function(e){return r.apply(this,arguments)}),u=function(){var e,s=(0,c.ZP)("https://api.coingecko.com/api/v3/coins/ethereum?localization=false&tickers=false&community_data=false&developer_data=false&sparkline=false",o,{refreshInterval:1e4}),t=s.data,r=(0,i.Z)(s,["data"]),a=null!==(e=t&&(d/Number(t)).toFixed(6))&&void 0!==e?e:null;return{eth:(0,n.Z)({data:t,perItem:a},r)}}},8522:function(e,s,t){"use strict";t.d(s,{Y:function(){return x}});var r=t(5893),a=t(2445),n=t(2993),i=t(2041),l=t(5675),c=t.n(l);function d(){var e=(0,i.B)().eth;return(0,r.jsxs)("div",{className:"flex flex-col xs:flex-row text-center",children:[(0,r.jsxs)("div",{className:"p-6 border drop-shadow rounded-md mr-2",children:[(0,r.jsx)("div",{className:"flex items-center justify-center",children:e.data?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c(),{layout:"fixed",height:"35",width:"35",src:"/small-eth.webp"}),(0,r.jsxs)("span",{className:"text-xl font-bold",children:["= ",e.data,"$"]})]}):(0,r.jsx)("div",{className:"w-full flex justify-center",children:(0,r.jsx)(n.aN,{size:"md"})})}),(0,r.jsx)("p",{className:"text-lg text-gray-500",children:"Current eth Price"})]}),(0,r.jsxs)("div",{className:"p-6 border drop-shadow rounded-md",children:[(0,r.jsx)("div",{className:"flex items-center justify-center",children:e.data?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-xl font-bold",children:e.perItem}),(0,r.jsx)(c(),{layout:"fixed",height:"35",width:"35",src:"/small-eth.webp"}),(0,r.jsxs)("span",{className:"text-xl font-bold",children:["= ",i.x,"$"]})]}):(0,r.jsx)("div",{className:"w-full flex justify-center",children:(0,r.jsx)(n.aN,{size:"md"})})}),(0,r.jsx)("p",{className:"text-lg text-gray-500",children:"Price per course"})]})]})}var o=t(4853);function u(){var e=(0,o.$)().requireInstall,s=(0,a.vL)(),t=s.account,i=s.network;return(0,r.jsx)("section",{className:"text-white bg-indigo-600 rounded-lg",children:(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsxs)("h1",{className:"text-base xs:text-xl break-words",children:["Hello, ",t.data]}),(0,r.jsx)("h2",{className:"subtitle mb-5 text-sm xs:text-base",children:"I hope you are having a great day!"}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("div",{className:"sm:flex sm:justify-center lg:justify-start",children:(0,r.jsx)(n.zx,{className:"mr-2 text-sm xs:text-lg p-2",variant:"white",children:"Learn how to purchase"})}),(0,r.jsxs)("div",{children:[i.hasInitialResponse&&!i.isSupported&&(0,r.jsxs)("div",{className:"bg-red-400 p-4 rounded-lg",children:[(0,r.jsx)("div",{children:"Connected to wrong network"}),(0,r.jsxs)("div",{children:["Connect to: "," ",(0,r.jsx)("strong",{className:"text-2xl",children:i.target})]})]}),e&&(0,r.jsx)("div",{className:"bg-yellow-500 p-4 rounded-lg",children:"Cannot connect to network. Please install Metamask."}),i.data&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"Currently on "}),(0,r.jsx)("strong",{className:"text-2xl",children:i.data})]})]})]})]})})}var m=[{href:"/marketplace",value:"Buy"},{href:"/marketplace/courses/owned",value:"My Courses"},{href:"/marketplace/courses/manage",value:"Manage Courses",requireAdmin:!0}];function x(){var e=(0,a.mA)().account;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsx)(u,{})}),(0,r.jsx)(d,{}),(0,r.jsx)("div",{className:"flex flex-row-reverse p-4 sm:px-6 lg:px-8",children:(0,r.jsx)(n.Oo,{isAdmin:e.isAdmin,items:m})})]})}},1707:function(e,s,t){"use strict";t.r(s),t.d(s,{__N_SSG:function(){return N},default:function(){return y}});var r=t(7568),a=t(6042),n=t(9396),i=t(9815),l=t(655),c=t(5893),d=t(2445),o=t(2993),u=t(724),m=t(2041),x=t(7294),h={price:"",email:"",confirmationEmail:""},f=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{isDisabled:e,message:s}},p=function(e,s,t){var r=e.price,a=e.email,n=e.confirmationEmail;if(!r||0>=Number(r))return f(!0,"Price is not valid.");if(t){if(0===n.length||0===a.length)return f(!0);if(a!==n)return f(!0,"Email are not matching.")}else if(!s)return f(!0,"You need to accept terms of service.");return f()};function v(e){var s=e.course,t=e.onClose,r=e.onSubmit,i=e.isNewPurchase,l=(0,x.useState)(!1),d=l[0],u=l[1],f=(0,x.useState)(h),v=f[0],j=f[1],g=(0,x.useState)(!1),b=g[0],N=g[1],y=(0,x.useState)(!1),w=y[0],k=y[1],C=(0,m.B)().eth;(0,x.useEffect)(function(){s&&(u(!0),j((0,n.Z)((0,a.Z)({},h),{price:C.perItem})))},[s]);var _=function(){u(!1),j(h),k(!1),N(!1),t()},z=p(v,w,i);return(0,c.jsx)(o.u_,{isOpen:d,children:(0,c.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,c.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,c.jsx)("div",{className:"sm:flex sm:items-start",children:(0,c.jsxs)("div",{className:"mt-3 sm:mt-0 sm:ml-4 sm:text-left",children:[(0,c.jsx)("h3",{className:"mb-7 text-lg font-bold leading-6 text-gray-900",id:"modal-title",children:s.title}),(0,c.jsxs)("div",{className:"mt-1 relative rounded-md",children:[(0,c.jsxs)("div",{className:"mb-1",children:[(0,c.jsx)("label",{className:"mb-2 font-bold",children:"Price(eth)"}),(0,c.jsxs)("div",{className:"text-xs text-gray-700 flex",children:[(0,c.jsx)("label",{className:"flex items-center mr-2",children:(0,c.jsx)("input",{onChange:function(e){var s=e.target.checked;j((0,n.Z)((0,a.Z)({},v),{price:s?v.price:C.perItem})),N(s)},checked:b,type:"checkbox",className:"form-checkbox"})}),(0,c.jsx)("span",{children:"Adjust Price - only when the price is not correct"})]})]}),(0,c.jsx)("input",{disabled:!b,onChange:function(e){var s=e.target.value;!isNaN(s)&&j((0,n.Z)((0,a.Z)({},v),{price:s}))},value:v.price,type:"text",name:"price",id:"price",className:"disabled:opacity-50 w-80 mb-1 focus:ring-indigo-500 shadow-md focus:border-indigo-500 block pl-7 p-4 sm:text-sm border-gray-300 rounded-md"}),(0,c.jsx)("p",{className:"text-xs text-gray-700",children:"Price will be verified at the time of the order. If the price will be lower, order can be declined (+- 2% slipage is allowed)"})]}),i&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"mt-2 relative rounded-md",children:[(0,c.jsx)("div",{className:"mb-1",children:(0,c.jsx)("label",{className:"mb-2 font-bold",children:"Email"})}),(0,c.jsx)("input",{onChange:function(e){var s=e.target.value;j((0,n.Z)((0,a.Z)({},v),{email:s.trim()}))},value:v.email,type:"email",name:"email",id:"email",className:"w-80 focus:ring-indigo-500 shadow-md focus:border-indigo-500 block pl-7 p-4 sm:text-sm border-gray-300 rounded-md",placeholder:"x@y.com"}),(0,c.jsx)("p",{className:"text-xs text-gray-700 mt-1",children:"It's important to fill a correct email, otherwise the order cannot be verified. We are not storing your email anywhere"})]}),(0,c.jsxs)("div",{className:"my-2 relative rounded-md",children:[(0,c.jsx)("div",{className:"mb-1",children:(0,c.jsx)("label",{className:"mb-2 font-bold",children:"Repeat Email"})}),(0,c.jsx)("input",{onChange:function(e){var s=e.target.value;j((0,n.Z)((0,a.Z)({},v),{confirmationEmail:s.trim()}))},value:v.confirmationEmail,type:"email",name:"confirmationEmail",id:"confirmationEmail",className:"w-80 focus:ring-indigo-500 shadow-md focus:border-indigo-500 block pl-7 p-4 sm:text-sm border-gray-300 rounded-md",placeholder:"x@y.com"})]})]}),(0,c.jsxs)("div",{className:"text-xs text-gray-700 flex mt-5",children:[(0,c.jsx)("label",{className:"flex items-center mr-2",children:(0,c.jsx)("input",{checked:w,onChange:function(e){k(e.target.checked)},type:"checkbox",className:"form-checkbox"})}),(0,c.jsx)("span",{children:"I accept Eincode 'terms of service' and I agree that my order can be rejected in the case data provided above are not correct"})]}),z.message&&(0,c.jsx)("div",{className:"p-4 my-3 text-red-700 bg-red-200 rounded-lg text-sm",children:z.message})]})})}),(0,c.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex",children:[(0,c.jsx)(o.zx,{disabled:z.isDisabled,onClick:function(){r(v,s)},children:"Submit"}),(0,c.jsx)(o.zx,{onClick:_,variant:"red",children:"Cancel"})]})]})})}var j=t(8522),g=t(4853),b=t(2881),N=!0;function y(e){var s,t,m,h=e.courses,f=(0,x.useState)(null),p=f[0],N=f[1],y=(0,x.useState)(!0),w=y[0],k=y[1],C=(0,x.useState)(null),_=C[0],z=C[1],I=(0,g.$)(),Z=I.web3,E=I.contract,S=I.requireInstall,P=(0,d.vL)(),F=P.isConnecting,A=P.hasConnectedWallet,H=P.account,D=P.network,T=(0,d.Ce)(h,H.data,D.data).ownedCourses,Y=(s=(0,r.Z)(function(e,s){var t,r,a,n,i;return(0,l.__generator)(this,function(l){return t=Z.utils.utf8ToHex(s.id),r=Z.utils.soliditySha3({type:"bytes16",value:t},{type:"address",value:H.data}),a=Z.utils.toWei(String(e.price)),z(s.id),w?(n=Z.utils.sha3(e.email),i=Z.utils.soliditySha3({type:"bytes32",value:n},{type:"bytes32",value:r}),(0,b.f)(B({hexCourseId:t,proof:i,value:a},s))):(0,b.f)(L({courseHash:r,value:a},s)),[2]})}),function(e,t){return s.apply(this,arguments)}),B=(t=(0,r.Z)(function(e,s){var t,r,c,d,o;return(0,l.__generator)(this,function(l){switch(l.label){case 0:t=e.hexCourseId,r=e.proof,c=e.value,l.label=1;case 1:return l.trys.push([1,3,4,5]),[4,E.methods.purchaseCourse(t,r).send({from:H.data,value:c})];case 2:return d=l.sent(),T.mutate((0,i.Z)(T.data).concat([(0,n.Z)((0,a.Z)({},s),{proof:r,state:"purchase",owner:H.data,price:c})])),[2,d];case 3:throw Error(l.sent().message);case 4:return z(null),[7];case 5:return[2]}})}),function(e,s){return t.apply(this,arguments)}),L=(m=(0,r.Z)(function(e,s){var t,r,a,n,i;return(0,l.__generator)(this,function(i){switch(i.label){case 0:t=e.courseHash,r=e.value,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,E.methods.repurchaseCourse(t).send({from:H.data,value:r})];case 2:return a=i.sent(),(n=T.data.findIndex(function(e){return e.id===s.id}))>=0?(T.data[n].state="purchased",T.mutate(T.data)):T.mutate(),[2,a];case 3:throw Error(i.sent().message);case 4:return z(null),[7];case 5:return[2]}})}),function(e,s){return m.apply(this,arguments)}),O=function(){N(null),k(!0)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(j.Y,{}),(0,c.jsx)(u.cQ,{courses:h,children:function(e){var s=T.lookup[e.id];return(0,c.jsx)(u.Pg,{course:e,state:null==s?void 0:s.state,disabled:!A,Footer:function(){if(S)return(0,c.jsx)(o.zx,{size:"sm",disabled:!0,variant:"lightPurple",children:"Install"});if(F)return(0,c.jsx)(o.zx,{size:"sm",disabled:!0,variant:"lightPurple",children:(0,c.jsx)(o.aN,{size:"sm"})});if(!T.hasInitialResponse)return(0,c.jsx)(o.zx,{size:"sm",disabled:!0,children:A?"Loading State...":"Connect"});var t=_===e.id;return s?(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)(o.zx,{size:"sm",onClick:function(){return alert("You are owner of this course.")},disabled:!1,variant:"green",children:"Yours ✔"}),"deactivated"===s.state&&(0,c.jsx)("div",{className:"ml-1",children:(0,c.jsx)(o.zx,{size:"sm",disabled:!1,onClick:function(){k(!1),N(e)},variant:"purple",children:t?(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(o.aN,{size:"sm"}),(0,c.jsx)("div",{className:"ml-2",children:"In progress"})]}):"Fund to Activate"})})]})}):(0,c.jsx)(o.zx,{size:"sm",onClick:function(){return N(e)},disabled:!A,variant:"lightPurple",children:t?(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(o.aN,{size:"sm"}),(0,c.jsx)("div",{className:"ml-2",children:"In progress"})]}):"Purchase"})}},e.id)}}),p&&(0,c.jsx)(v,{isNewPurchase:w,onSubmit:function(e,s){Y(e,s),O()},course:p,onClose:O})]})}},2881:function(e,s,t){"use strict";t.d(s,{f:function(){return n}});var r=t(5893),a=t(2920),n=function(e){a.Am.promise(e,{pending:{render:function(){return(0,r.jsx)("div",{className:"p-6 py-2",children:(0,r.jsx)("p",{className:"mb-2",children:"Your transaction is being processed."})})},icon:!1},success:{render:function(e){var s=e.data;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-bold",children:["Tx: ",s.transactionHash.slice(0,20),"..."]}),(0,r.jsx)("p",{children:"Has been succesfuly processed."}),(0,r.jsx)("a",{href:"https://ropsten.etherscan.io/tx/".concat(s.transactionHash),target:"_blank",children:(0,r.jsx)("i",{className:"text-indigo-600 underline",children:"See Tx Details"})})]})},icon:"\uD83D\uDFE2"},error:{render:function(e){var s,t=e.data;return(0,r.jsx)("div",{children:null!==(s=t.message)&&void 0!==s?s:"Transaction has failed"})}}})}}},function(e){e.O(0,[256,724,774,888,179],function(){return e(e.s=2694)}),_N_E=e.O()}]);